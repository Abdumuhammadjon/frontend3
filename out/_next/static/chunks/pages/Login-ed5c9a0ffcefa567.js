(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[615],{4175:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/Login",function(){return a(3379)}])},3379:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var s=a(4848),r=a(6540),o=a(1106),l=a.n(o),n=a(6715),i=a(4335),d=a(8987);class c extends Error{}function u(e,t){let a;if("string"!=typeof e)throw new c("Invalid token specified: must be a string");t||(t={});let s=!0===t.header?0:1,r=e.split(".")[s];if("string"!=typeof r)throw new c(`Invalid token specified: missing part #${s+1}`);try{a=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var a;return a=t,decodeURIComponent(atob(a).replace(/(.)/g,(e,t)=>{let a=t.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}catch(e){return atob(t)}}(r)}catch(e){throw new c(`Invalid token specified: invalid base64 for part #${s+1} (${e.message})`)}try{return JSON.parse(a)}catch(e){throw new c(`Invalid token specified: invalid json for part #${s+1} (${e.message})`)}}c.prototype.name="InvalidTokenError";let m=()=>{let[e,t]=(0,r.useState)({email:"",password:""}),[a,o]=(0,r.useState)(null),c=(0,n.useRouter)();(0,r.useEffect)(()=>{let e=d.A.get("token");if(e)try{let t=u(e);console.log("\uD83D\uDD0D Decoded Token:",t.role),"admin"===t.role?setTimeout(()=>c.push("/questions"),100):setTimeout(()=>c.push("/"),100)}catch(e){console.error("❌ Token decode qilishda xatolik:",e)}},[c]);let m=a=>{t({...e,[a.target.name]:a.target.value})},h=async t=>{t.preventDefault(),o(null);try{let t=await i.A.post("https://backed1.onrender.com/auth/login",e,{headers:{"Content-Type":"application/json"},withCredentials:!0});localStorage.setItem("subjectId",t.data.subjectId),localStorage.setItem("adminId",t.data.adminId),localStorage.setItem("token",t.data.token),localStorage.setItem("userId",t.data.adminId),localStorage.setItem("role",t.data.role);let a=t.data.token;if(!a)throw Error("Token kelmadi!");d.A.set("token",a,{expires:1});let s=u(a);console.log("\uD83D\uDFE2 Token:",s,"salom"),console.log("\uD83D\uDFE2 Tokeni:",s.role,"salom"),"superadmin"===s.role?c.push("/adminlar"):"admin"===s.role?c.push("/questions"):c.push("/quiz"),console.log("✅ Login successful:",t.data.subjectId)}catch(e){var a,s,r,l;console.error("❌ Login error:",(null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.message)||e.message),o((null===(l=e.response)||void 0===l?void 0:null===(r=l.data)||void 0===r?void 0:r.message)||"Login failed")}};return(0,s.jsx)("div",{className:"flex justify-center items-center h-screen bg-gray-100",children:(0,s.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md w-96",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-center mb-6",children:"Login"}),a&&(0,s.jsx)("p",{className:"text-red-500 text-center",children:a}),(0,s.jsxs)("form",{onSubmit:h,children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-700",children:"Email"}),(0,s.jsx)("input",{type:"email",name:"email",value:e.email,onChange:m,required:!0,className:"w-full p-2 border rounded mt-1",placeholder:"Enter your email"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-700",children:"Password"}),(0,s.jsx)("input",{type:"password",name:"password",value:e.password,onChange:m,required:!0,className:"w-full p-2 border rounded mt-1",placeholder:"Enter your password"})]}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600",children:"Login"})]}),(0,s.jsxs)("p",{className:"text-center mt-4 text-gray-600",children:["Don’t have an account?",(0,s.jsx)(l(),{href:"/register",className:"text-blue-500 ml-1",children:"Register"})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[106,636,593,792],()=>t(4175)),_N_E=e.O()}]);