(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[788],{4181:(a,e,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/Fanlar",function(){return s(2844)}])},2844:(a,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>m});var l=s(4848),t=s(6540),r=s(4335),n=s(6715);let i="http://localhost:5001/api",o=async()=>(await r.A.get("".concat(i,"/admins"))).data.admins,d=async()=>(await r.A.get("".concat(i,"/subjects"))).data,c=async(a,e)=>(await r.A.put("".concat(i,"/subjects/").concat(a),e)).data,u=async a=>(await r.A.delete("".concat(i,"/subjects/").concat(a))).data,m=()=>{let[a,e]=(0,t.useState)([]),[s,i]=(0,t.useState)(""),[m,h]=(0,t.useState)(""),[x,p]=(0,t.useState)([]),[b,v]=(0,t.useState)(null),[w,g]=(0,t.useState)(""),j=(0,n.useRouter)();(0,t.useEffect)(()=>{y(),N()},[]);let y=async()=>{try{let a=await d();e(a)}catch(a){console.error("Fanlarni olishda xatolik:",a)}},N=async()=>{try{let a=await o();p(a)}catch(a){console.error("Adminlarni olishda xatolik:",a)}},f=async()=>{if(!s.trim()||!m.trim()){g("Barcha maydonlarni to‘ldiring!");return}let a={name:s.trim(),admin:m.trim()};console.log("Yuborilayotgan ma'lumot:",a);try{let e=await r.A.post("".concat("https://backed1.onrender.com/api","/subjects"),a);console.log("Fan yaratildi:",e.data),i(""),h(""),g(""),y()}catch(a){var e,l,t;console.error("Fan qo‘shishda xatolik:",a.response?a.response.data:a.message),(null===(l=a.response)||void 0===l?void 0:null===(e=l.data)||void 0===e?void 0:e.error)?g(a.response.data.error):(null===(t=a.response)||void 0===t?void 0:t.status)===400?g("Noto‘g‘ri so‘rov! Ma’lumotlarni tekshiring."):g("Noma'lum xatolik yuz berdi!")}},k=async()=>{if(!b||!b.name||!b.admin){g("Barcha maydonlarni to‘ldiring!");return}try{await c(b.id,{name:b.name,admin:b.admin}),v(null),g(""),y()}catch(s){var a,e;console.error("Fan yangilashda xatolik:",s),g((null===(e=s.response)||void 0===e?void 0:null===(a=e.data)||void 0===a?void 0:a.error)||"Fan yangilashda xatolik yuz berdi!")}},_=async a=>{if(window.confirm("Haqiqatan ham o‘chirmoqchimisiz?"))try{await u(a),y()}catch(a){console.error("Fan o‘chirishda xatolik:",a),g("Fan o‘chirishda xatolik yuz berdi!")}};return(0,l.jsxs)("div",{className:"p-4 sm:p-6",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center w-full gap-4 mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold",children:"Fanlar"}),(0,l.jsx)("button",{onClick:()=>{j.push("/Superadmin")},className:"px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-700",children:"Orqaga"})]}),w&&(0,l.jsx)("div",{className:"mb-4 text-red-500",children:w}),(0,l.jsxs)("div",{className:"mb-4 flex flex-col sm:flex-row gap-2 w-full",children:[(0,l.jsx)("input",{type:"text",placeholder:"Fan nomi",value:s,onChange:a=>i(a.target.value),className:"border p-2 rounded w-full sm:w-auto"}),(0,l.jsxs)("select",{value:m,onChange:a=>h(a.target.value),className:"border p-2 rounded w-full sm:w-auto",children:[(0,l.jsx)("option",{value:"",children:"Admin tanlang"}),x.map(a=>(0,l.jsx)("option",{value:a.id,children:a.username},a.id))]}),(0,l.jsx)("button",{onClick:f,className:"bg-blue-500 text-white px-4 py-2 rounded w-full sm:w-auto",children:"Qo‘shish"})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-200 text-sm sm:text-base",children:[(0,l.jsx)("th",{className:"border p-2",children:"ID"}),(0,l.jsx)("th",{className:"border p-2",children:"Fan nomi"}),(0,l.jsx)("th",{className:"border p-2",children:"Admin"}),(0,l.jsx)("th",{className:"border p-2",children:"Harakatlar"})]})}),(0,l.jsx)("tbody",{children:a.map(a=>{var e;return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2",children:a.id}),(0,l.jsx)("td",{className:"border p-2",children:(null==b?void 0:b.id)===a.id?(0,l.jsx)("input",{type:"text",value:b.name,onChange:a=>v({...b,name:a.target.value}),className:"border p-1 w-full"}):a.name}),(0,l.jsx)("td",{className:"border p-2",children:(null==b?void 0:b.id)===a.id?(0,l.jsx)("select",{value:b.admin,onChange:a=>v({...b,admin:a.target.value}),className:"border p-1 w-full",children:x.map(a=>(0,l.jsx)("option",{value:a.id,children:a.username},a.id))}):(null===(e=x.find(e=>e.id===a.admin))||void 0===e?void 0:e.username)||"Noma'lum"}),(0,l.jsx)("td",{className:"border p-2",children:(null==b?void 0:b.id)===a.id?(0,l.jsx)("button",{onClick:k,className:"bg-green-500 text-white px-2 py-1 rounded",children:"Saqlash"}):(0,l.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,l.jsx)("button",{onClick:()=>v(a),className:"bg-yellow-500 text-white px-2 py-1 rounded",children:"Tahrirlash"}),(0,l.jsx)("button",{onClick:()=>_(a.id),className:"bg-red-500 text-white px-2 py-1 rounded",children:"O‘chirish"})]})})]},a.id)})})]})})]})}}},a=>{var e=e=>a(a.s=e);a.O(0,[636,593,792],()=>e(4181)),_N_E=a.O()}]);